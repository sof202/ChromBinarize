{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to the ChromBinarize wiki","text":"<p>These pages detail the scripts that exist in ChromBinarize.</p> <p>For installation instructions, please see the repository's README file</p>"},{"location":"#navigating-these-pages","title":"Navigating these pages","text":"<p>There are a few keyboard shortcuts you can use on this site for navigation:</p> <ul> <li><code>s</code> , <code>f</code> , <code>/</code> -&gt; Opens up the search bar (search all pages)</li> <li><code>n</code> , <code>.</code> -&gt; Goes to the next page</li> <li><code>p</code> , <code>,</code> -&gt; Goes to the previous page</li> </ul>"},{"location":"#included-scripts","title":"Included scripts","text":"<p>The scripts in this repository are split into four categories, click on the links below to learn more about the included scripts (or use the navigation bar on the left).</p> <ul> <li>ONT</li> <li>BS-Seq</li> <li>ChIP-Seq and ATAC-Seq</li> <li>Supplementary scripts</li> </ul>"},{"location":"BS-Seq/","title":"BS Seq","text":""},{"location":"BS-Seq/#bs-seq","title":"BS-Seq","text":"<p>For the most part, the BS-Seq scripts follow the same process as the ONT pipeline. The main difference is the expected format of the input file. The assumed format is that of the output from wgbs_tools. Specifically the <code>beta2bed</code> command.</p> Chromosome Start End Number of methylated reads Total reads"},{"location":"BS-Seq/#extracting-5hmc-signal","title":"Extracting 5hmC signal","text":"<p>If you have oxidative bisulphite sequencing data (alongside regular bisulphite  sequencing data), you can use them in tandem to extract sites that are exactly 5hmC. Oxidative bisulphite sequencing allows you to discern which sites are exactly 5mC. As such, this can be used to disentangle your bisulphite sequencing data into 5mC and 5hmC.</p> <p>In order to extract sites that have significant 5hmC signal, we unfortunately can't just remove the oxBS signal from the WGBS signal and use the same 'purification' method from the normal pipeline. This is because it is (at least currently) very unlikely that a site will be registered to have close to 100% signal in WGBS but close to 0% signal in oxBS. It's definitely plausible that this scenario can happen at certain sites in the genome, but (at least in our data) this is not seen anywhere even in neuronal cells. </p> <p>We also can't run the pipeline for both WGBS and oxBS then just remove the registered 5mC signal from the full methylation signal given by the WGBS data  (i.e perform a vector subtraction between the binary files). This is because a bin could feasibly be described by both 5mC and 5hmC, the marks are not mutually exclusive within regions of the genome.</p> <p>As a result, we take a different approach for extracting 5hmC. What we really  care about is the answer to the following question:</p> <p>Is there significant evidence to suggest that a site has a stronger signal in the WGBS data versus the oxBS data?</p> <p>If the answer to this question is yes, then we can infer that the contribution to the signal that 5hmC makes is significant. As such we can say that the site in question is significantly hydroxymethylated.</p>"},{"location":"ONT/","title":"ONT","text":""},{"location":"ONT/#ont","title":"ONT","text":"<p>This pipeline expects input bed files of the following format, which we define as 'bedmethyl' format (standard output of ONT's  modkit):</p> Chromosome Start End Mark name (m or h) Read depth Strand Percent methylation <p>These scripts have been created in an attempt to binarize the methylation and hydroxymethylation calls that come out of ONT data. The process is split into two steps:</p>"},{"location":"ONT/#purification","title":"Purification","text":"<p>In this step, 'poor sites' are removed from the dataset. Here 'poor sites' is  defined as: </p> <p>Sites that have a low read depth or are unlikely to be true  (hydroxy)methylation signal.</p> <p>This is done as there exists two sources of error in the 'percent methylation' metric that is given by ONT's pipeline (modified basecaller like <code>dorado</code>  alongside bed file generator like <code>modkit</code>). The first is errors in the  original signal track generated from the sequencing experiment. The second is errors from the base caller itself. We don't know what the true methylation signal looks like, so we can only remove sites that are 'unlikely' to be true methylation signal. </p> <p>[!NOTE] Optionally, you can pass the <code>-c</code> flag into the purification step to further filter the CpGs in the reference set to only be those that exist within known CpG islands (CGIs). CpG islands are usually unmethylated, making them a more reliable set (for CpGs that are truly unmethylated).</p> <p>However, if you are convinced that modified basecallers (such as dorado) perform worse when it comes to calling the methylation status of isolated CpGs: Do not use this option. Isolated CpGs have less context around them and so modified basecallers may have less accuracy.</p> <p>Two cpg islands files are provided out of the box in the 'references' directory of this repository (hg19 and hg38). These were obtained from UCSC's data integrator. If your data is not in these assemblies, you might be able to find the reference CGI file for your dataset here aswell.</p> <p>Once a suitable reference set is created, sites are determined to be true  methylation signal if: - They have a high enough read depth (user determined)  - They pass a statistical test using a binomial distribution. The test  attempts to answer this question:</p> <p>How probable is it that unmethylated cells are erroroneous or  unrepresentative cell types (of the total population)?</p> <p>This question is answered using a binomial distribution using probabilities  gathered from a 'good' reference set. By default, this 'good' reference set is a subset of the original data that only has sites with &gt;95% methylation and very high read depth (&gt;500). It is assumed that all reads in this dataset that are unmethylated are erroneous (or unrepresentative of the total population). Thus this subsetted dataset can be used to estimate a probability to use with the binomial distribution that can be applied to the whole dataset.</p>"},{"location":"ONT/#binarization","title":"Binarization","text":"<p>This step converts the now 'purified' ONT reads into the binarized data format that ChromHMM expects. That is, a single vector of 0s and 1s for each genomic bin/window/region.</p> <p>It is hard to binarize methylation data. For example, identifying regions that are 200bp in size that have a single CpG with methylation signal as 'regions characterised by methylation' feels wrong. However, restricting genomic bins that are  'characterised by methylation' to those with lots of methylated sites is very strict (resulting in almost a 0 vector). To combat this problem, this pipeline gets the best of both worlds. The binarization pulls out 'dense' and 'sparse' regions of (hydroxy)methylation.</p> <p>Dense regions of (hydroxy)methylation are defined as:</p> <p>Bins that have significantly high numbers of methylated CpGs  in comparison to the background</p> <p>'Significantly high' is determined using the beta distribution (with a default threshold of 0.001).</p> <p>Sparse regions of (hydroxy)methylation are defined as the remaining bins that have at least one site that is methylated.</p> <p>It is up to the user to decide whether to include each of these binary files in their subsequent analysis (you could even combine them if you wish).</p>"},{"location":"Peak_Called_Data/","title":"Peak Called Data","text":""},{"location":"Peak_Called_Data/#peak-called-data-chip-atac-etc","title":"Peak called data (ChIP, ATAC etc.)","text":"<p>It is currently assumed that your peak called data has already been peak  called by an external program such as  MACS.</p> <p>This is a very simple script that converts the peaks called by such a program into the binary format that is expected by ChromHMM. Make sure your input bed file for this script is of the format specified  here.</p> <p>All that is really required is the chromosome, start and end fields. Just ensure that these fields are indeed corresponding with the called peaks and not something else.</p>"},{"location":"Supplementary_Scripts/","title":"Supplementary Scripts","text":""},{"location":"Supplementary_Scripts/#supplementary-scripts","title":"Supplementary Scripts","text":"<p>There are 4 different scripts included in this folder. They are mainly here to empower the user to further inspect their data.</p>"},{"location":"Supplementary_Scripts/#erroneous-rate-plot","title":"Erroneous rate plot","text":"<p>This script is in place so that the user can inspect how the arbitrary decision of choosing a 'good' reference set changes the parameter used with the binomial distribution in the purificaiton step (for ONT and BS-Seq).</p> <p>In an ideal world, this arbitrary decision should not matter, i.e. peturbing the values will not change the output parameter too heavily. This isn't always the case, and so it is wise to check if this bothers you.</p>"},{"location":"Supplementary_Scripts/#cpg-robustness","title":"CpG robustness","text":"<p>This script was born out of distrust in a certain base caller. If a basecaller's output is to be trusted, you at least expect it to be consistent with itself. This script plots how similar the (hydroxy)methylation calls are between nearby CpGs. Ideally, close CpGs should generally be of the same methylation status. It would indeed be strange if CpGs with no methylation are usually situated next to fully methylated CpGs. This script allows you to check this hypothesis for your data.</p>"},{"location":"Supplementary_Scripts/#wgbs-comparison","title":"WGBS comparison","text":"<p>This script allows you to compare two methylation datasets. One being from ONT data, and the other being from WGBS. Ideally, if the two datasets are of the same cell type and from the same sample, they should match up pretty well. </p> <p>This script outputs 3 histograms. </p> <p>1) The absolute change in read depth between the same sites (sense checking) 2) The absolute change in methylation percent at the same site 3) The methylation percent in ONT vs the methylation percent in WGBS  (2d histogram)</p>"},{"location":"Supplementary_Scripts/#oxbs-comparison","title":"oxBS comparison","text":"<p>This is the same as WGBS comparison, but now expects oxBS data instead. This allows the user to specifically look at how the hydroxymethylation calls  compare between ONT and oxidative bisulphite sequencing. </p>"},{"location":"Supplementary_Scripts/#changing-bin-size","title":"Changing bin size","text":"<p>This is a script that allows the user to change the bin size used for a binary file. This can be very useful when working with multiple modalities. For example, you may want to use a bin size of 150bp for ATAC data, but use a bin size of 300 for your BS-Seq data. This script allows you to do both of these things, but still keep the binary files compatible within ChromHMM. You can now convert the 300bp binary file into a 150bp binary file so that both binary files have the same number of lines.</p> <p>This works in the simplest way possible. Each bin in the new binary file (that lies within a bin of the original binary file) will take on the same  value as in the original binary file.</p> <p>[!WARNING] It is not reccomended that you convert a binary file to have a larger bin size using this script. This is because you can't make the assumption that you would still have a peak in a wider area. Imagine you combined 3 bins together where only one bin had a peak, you probably would agree that the combined bin shouldn't have a peak. But what about the case where you combine two bins, one with a peak and the other without. What should you do then? It is better to just avoid this entirely and re-call the binarization script for a larger bin size.</p> <p>To learn how the script works (in terms of positional arguments), run the script without any arguments.</p>"}]}