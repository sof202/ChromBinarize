
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for ChromBinarize">
      
      
        <meta name="author" content="Sam Fletcher">
      
      
      
        <link rel="prev" href="../BS-Seq/">
      
      
        <link rel="next" href="../Peak_Called_Data/">
      
      
      <link rel="icon" href="../logo.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>ONT - ChromBinarize Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="green">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ont" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ChromBinarize Documentation" class="md-header__button md-logo" aria-label="ChromBinarize Documentation" data-md-component="logo">
      
  <img src="../logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ChromBinarize Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ONT
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/sof202/ChromBinarize" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ChromBinarize Documentation" class="md-nav__button md-logo" aria-label="ChromBinarize Documentation" data-md-component="logo">
      
  <img src="../logo.svg" alt="logo">

    </a>
    ChromBinarize Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/sof202/ChromBinarize" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to the ChromBinarize wiki
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../BS-Seq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BS Seq
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    ONT
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    ONT
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ont" class="md-nav__link">
    <span class="md-ellipsis">
      ONT
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ONT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#purification" class="md-nav__link">
    <span class="md-ellipsis">
      Purification
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#binarization" class="md-nav__link">
    <span class="md-ellipsis">
      Binarization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Peak_Called_Data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Peak Called Data
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Supplementary_Scripts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Supplementary Scripts
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ont" class="md-nav__link">
    <span class="md-ellipsis">
      ONT
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ONT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#purification" class="md-nav__link">
    <span class="md-ellipsis">
      Purification
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#binarization" class="md-nav__link">
    <span class="md-ellipsis">
      Binarization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>ONT</h1>

<h2 id="ont">ONT</h2>
<p>This pipeline expects input bed files of the following format, which we define
as 'bedmethyl' format (standard output of ONT's 
<a href="https://github.com/nanoporetech/modkit">modkit</a>):</p>
<table>
<thead>
<tr>
<th>Chromosome</th>
<th>Start</th>
<th>End</th>
<th>Mark name (m or h)</th>
<th>Read depth</th>
<th>Strand</th>
<th>Percent methylation</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>These scripts have been created in an attempt to binarize the methylation and
hydroxymethylation calls that come out of ONT data. The process is split into
two steps:</p>
<h3 id="purification">Purification</h3>
<p>In this step, 'poor sites' are removed from the dataset. Here 'poor sites' is 
defined as: </p>
<blockquote>
<p>Sites that have a low read depth or are unlikely to be true 
(hydroxy)methylation signal.</p>
</blockquote>
<p>This is done as there exists two sources of error in the 'percent methylation'
metric that is given by ONT's pipeline (modified basecaller like <code>dorado</code> 
alongside bed file generator like <code>modkit</code>). The first is errors in the 
original signal track generated from the sequencing experiment. The second is
errors from the base caller itself. We don't know what the true methylation
signal looks like, so we can only remove sites that are 'unlikely' to be true
methylation signal. </p>
<blockquote>
<p>[!NOTE]
Optionally, you can pass the <code>-c</code> flag into the purification step to further
filter the CpGs in the reference set to only be those that exist within
known CpG islands (CGIs). CpG islands are usually unmethylated, making them
a more reliable set (for CpGs that are truly unmethylated).</p>
<p>However, if you are convinced that modified basecallers (such as dorado)
perform worse when it comes to calling the methylation status of isolated
CpGs: Do not use this option. Isolated CpGs have less context around them
and so modified basecallers may have less accuracy.</p>
<p>Two cpg islands files are provided out of the box in the 'references'
directory of this repository (hg19 and hg38). These were obtained from
UCSC's <a href="https://genome.ucsc.edu/cgi-bin/hgIntegrator">data integrator</a>.
If your data is not in these assemblies, you might be able to find the
reference CGI file for your dataset here aswell.</p>
</blockquote>
<p>Once a suitable reference set is created, sites are determined to be true 
methylation signal if:
- They have a high enough read depth (user determined) 
- They pass a statistical test using a binomial distribution. The test 
attempts to answer this question:</p>
<blockquote>
<p>How probable is it that unmethylated cells are erroroneous or 
unrepresentative cell types (of the total population)?</p>
</blockquote>
<p>This question is answered using a binomial distribution using probabilities 
gathered from a 'good' reference set. By default, this 'good' reference set is
a subset of the original data that only has sites with &gt;95% methylation and
very high read depth (&gt;500). It is assumed that all reads in this dataset that
are unmethylated are erroneous (or unrepresentative of the total population).
Thus this subsetted dataset can be used to estimate a probability to use with
the binomial distribution that can be applied to the whole dataset.</p>
<h3 id="binarization">Binarization</h3>
<p>This step converts the now 'purified' ONT reads into the binarized data format
that ChromHMM expects. That is, a single vector of 0s and 1s for each genomic
bin/window/region.</p>
<p>It is hard to binarize methylation data. For example, identifying regions that are 200bp in
size that have a single CpG with methylation signal as 'regions characterised
by methylation' feels wrong. However, restricting genomic bins that are 
'characterised by methylation' to those with lots of methylated sites is very
strict (resulting in almost a 0 vector). To combat this problem, this pipeline
gets the best of both worlds. The binarization pulls out 'dense' and 'sparse'
regions of (hydroxy)methylation.</p>
<p>Dense regions of (hydroxy)methylation are defined as:</p>
<blockquote>
<p>Bins that have significantly high numbers of methylated CpGs 
in comparison to the background</p>
</blockquote>
<p>'Significantly high' is determined using the beta distribution
(with a default threshold of 0.001).</p>
<p>Sparse regions of (hydroxy)methylation are defined as the remaining bins that
have at least one site that is methylated.</p>
<p>It is up to the user to decide whether to include each of these binary files
in their subsequent analysis (you could even combine them if you wish).</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Â© 2024, Sam Fletcher
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>